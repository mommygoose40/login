<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LINE 登入中...</title>
<script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>

<style>
  body{
    font-family: Arial;
    text-align:center;
    padding-top: 60px;
  }
</style>
</head>

<body>
<h2>登入中，請稍候...</h2>

<script>
const LIFF_ID = "2007934728-q468EB12";
const GAS_URL = "https://script.google.com/macros/s/AKfycbwQ2G5azRrHL0Qw4xaVwbh8yDqKGLWPPwsZixqcmDSg6wsnl95-tlbG24oX8jLjo1Ga/exec?action=checkRegistered";

async function main() {

  liff.init({ liffId: LIFF_ID })
    .then(async () => {
      console.log("LIFF 初始化成功");

      if (!liff.isLoggedIn()) {
        console.log("未登入，跳 LINE login");
        liff.login();
        return;
      }

      console.log("已登入，取得 profile...");
      const profile = await liff.getProfile();
      console.log("PROFILE：", profile);

      document.body.innerHTML = `<h2>已登入 LINE：${profile.displayName}</h2>`;
    })
    .catch(err => {
      console.error("LIFF 初始化錯誤：", err);
      document.body.innerHTML = `
        <h2 style="color:red;">LIFF 初始化錯誤</h2>
        <p>${err.message}</p>
      `;
    });
}

main();
</script>

</body>
</html>
